<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GUDEX - Panel de Administración</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    
    <header class="admin-header">
        <img src="logo.png" alt="Logo GUDEX" class="logo-admin">
        <h2>Panel de Administración</h2>
        <button id="logout-button" class="btn-logout">Cerrar Sesión</button>
    </header>

    <div class="admin-layout">
        
        <nav class="sidebar">
            <ul class="sidebar-nav">
                <li><a href="#" class="nav-link active" data-view="citas">Dashboard Citas</a></li>
                <li><a href="#" class="nav-link" data-view="clientes">Gestión Clientes</a></li>
                <li><a href="#" class="nav-link" data-view="config-vehiculos">Marcas y Modelos</a> <li><a href="#" class="nav-link" data-view="estadisticas">Estadísticas</a></li>
                <li><a href="#" class="nav-link" data-view="sistema">Sistema y Respaldos</a></li>
            </ul>
        </nav>

        <main class="main-content">

            <div id="view-citas" class="content-view active">
                <div class="dashboard-grid">
                    <div class="card dashboard-card">
                        <h3><span class="status-dot status-pendiente"></span>Citas Pendientes</h3>
                        <ul id="lista-citas-pendientes-ul" class="lista-citas"><li>Cargando...</li></ul>
                    </div>
                    <div class="card dashboard-card">
                        <h3><span class="status-dot status-confirmada"></span>Citas Confirmadas</h3>
                        <ul id="lista-citas-confirmadas-ul" class="lista-citas"><li>Cargando...</li></ul>
                    </div>
                    <div class="card dashboard-card">
                        <h3><span class="status-dot status-terminada"></span>Citas Terminadas (Hoy)</h3>
                        <ul id="lista-citas-terminadas-ul" class="lista-citas"><li>Cargando...</li></ul>
                    </div>
                </div>
            </div>
            
            <div id="view-buscador" class="content-view">
                <div class="card admin-form">
                    <h3>Buscar Vehículo</h3>
                    <form id="form-buscador-patente">
                        <label>Ingrese Patente:</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="busqueda-patente" placeholder="Ej: ABCD12" required style="text-transform: uppercase;">
                            <button type="submit" style="margin-top: 0;">Buscar</button>
                        </div>
                    </form>
                </div>
                <div id="resultado-busqueda" class="hidden">
                    <div class="card">
                        <h3>Datos del Vehículo y Propietario</h3>
                        <div style="display: flex; justify-content: space-between; flex-wrap: wrap;">
                            <div>
                                <p><strong>Patente:</strong> <span id="res-patente"></span></p>
                                <p><strong>Marca/Modelo:</strong> <span id="res-marca-modelo"></span></p>
                                <p><strong>Año:</strong> <span id="res-anio"></span></p>
                            </div>
                            <div>
                                <p><strong>Cliente:</strong> <span id="res-cliente"></span></p>
                                <p><strong>Email:</strong> <span id="res-email"></span></p>
                                <p><strong>Teléfono:</strong> <span id="res-telefono"></span></p>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Historial de Mantenciones</h3>
                        <ul id="res-lista-historial" class="lista-citas"></ul>
                    </div>
                </div>
            </div>

            <div id="view-clientes" class="content-view">
                <div class="admin-container-clientes">
                    <section class="admin-column">
                        <div class="card admin-form">
                            <h3>Registrar Cliente</h3>
                            <form id="form-crear-cliente">
                                <label>Nombre:</label><input type="text" id="admin-nombre" required>
                                <label>Email:</label><input type="email" id="admin-email" required>
                                <label>Contraseña:</label><input type="password" id="admin-password" required>
                                <label>Teléfono:</label><input type="tel" id="admin-telefono">
                                <label>Rol:</label><select id="admin-role"><option value="cliente">Cliente</option><option value="admin">Admin</option></select>
                                <button type="submit">Crear Cliente</button>
                            </form>
                        </div>
                        <div class="card">
                            <h3>Lista de Clientes</h3>
                            <ul id="lista-clientes-ul"><li>Cargando...</li></ul>
                        </div>
                    </section>
                    
                    <section class="admin-column hidden" id="columna-detalles">
                        <div class="card">
                            <h3 id="detalle-cliente-nombre">Cliente</h3>
                            <p id="detalle-cliente-info"></p>
                        </div>
                        <div class="card admin-form">
                            <h3>Agregar Vehículo</h3>
                            <form id="form-agregar-vehiculo">
                                <label>Patente:</label><input type="text" id="admin-patente" required>
                                <label>Marca:</label><select id="admin-marca" required><option value="">Cargando...</option></select>
                                <label>Modelo:</label><select id="admin-modelo" required><option value="">Selecciona marca</option></select>
                                <label>Año:</label><input type="number" id="admin-anio">
                                <button type="submit">Agregar Vehículo</button>
                            </form>
                        </div>
                        <div class="card">
                            <h3>Vehículos</h3>
                            <ul id="lista-vehiculos-ul"><li>Selecciona un cliente...</li></ul>
                        </div>
                        <div class="card admin-form">
                            <h3>Registrar Mantenimiento</h3>
                            <form id="form-agregar-mantenimiento">
                                <label>Fecha:</label><input type="date" id="admin-mantenimiento-fecha" required>
                                <label>KM:</label><input type="number" id="admin-mantenimiento-km">
                                <label>Trabajos:</label><textarea id="admin-mantenimiento-trabajos" rows="3" required></textarea>
                                <label>Repuestos:</label><textarea id="admin-mantenimiento-repuestos" rows="2"></textarea>
                                <label>Sugerencia:</label><textarea id="admin-mantenimiento-sugerencia" rows="2"></textarea>
                                <label>Próximo KM:</label><input type="number" id="admin-mantenimiento-prox-km">
                                <button type="submit">Registrar</button>
                            </form>
                        </div>
                        <div class="card">
                            <h3>Historial</h3>
                            <ul id="lista-historial-ul"><li>Selecciona un vehículo...</li></ul>
                        </div>
                    </section>
                </div>
            </div>

            <div id="view-config-vehiculos" class="content-view">
                <div class="admin-container-clientes">
                    <section class="admin-column">
                        <div class="card admin-form">
                            <h3>Agregar Nueva Marca</h3>
                            <form id="form-crear-marca">
                                <label>Nombre Marca:</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" id="nueva-marca-nombre" required placeholder="Ej: Ferrari">
                                    <button type="submit" style="margin-top: 0;">Añadir</button>
                                </div>
                            </form>
                        </div>
                        <div class="card">
                            <h3>Listado de Marcas</h3>
                            <p style="font-size: 0.9rem; color: #666;">Haz clic para ver modelos.</p>
                            <ul id="lista-config-marcas" class="config-list"><li>Cargando...</li></ul>
                        </div>
                    </section>
                    <section class="admin-column">
                        <div class="card">
                            <h3 id="titulo-modelos-marca">Modelos</h3>
                            <p id="info-modelos-marca">Selecciona una marca de la izquierda.</p>
                            <div id="panel-modelos" class="hidden">
                                <form id="form-crear-modelo" style="margin-bottom: 1rem;">
                                    <label>Nuevo Modelo:</label>
                                    <div style="display: flex; gap: 10px;">
                                        <input type="text" id="nuevo-modelo-nombre" required placeholder="Ej: Enzo">
                                        <button type="submit" style="margin-top: 0;">Añadir</button>
                                    </div>
                                </form>
                                <ul id="lista-config-modelos" class="config-list"><li>Cargando...</li></ul>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

            <div id="view-estadisticas" class="content-view">
                <div class="card">
                    <h2>Estadísticas</h2>
                    <div class="stat-container">
                        <h3>Top 5 Marcas con Más Mantenciones</h3>
                        <div id="chart-marcas-top" class="chart-container"><p>Cargando...</p></div>
                    </div>
                </div>
            </div>

            <div id="view-sistema" class="content-view">
                <div class="dashboard-grid">
                    <div class="card admin-form">
                        <h3>Respaldo BD (.db)</h3>
                        <form id="form-backup-restore"> 
                            <button type="button" id="btn-descargar-backup" class="btn-descargar">Descargar DB</button>
                            <hr class="form-hr">
                            <label>Restaurar (.db):</label><input type="file" id="backup-file" accept=".db">
                            <button type="submit" id="btn-restaurar-backup" class="btn-delete">Restaurar</button>
                        </form>
                    </div>
                    <div class="card admin-form">
                        <h3>Carga Masiva (XLS)</h3>
                        <form id="form-excel-restore"> 
                            <button type="button" id="btn-descargar-excel" class="btn-excel">Descargar Plantilla</button>
                            <hr class="form-hr">
                            <label>Subir Excel:</label><input type="file" id="excel-file" accept=".xls,.xlsx">
                            <button type="submit" id="btn-restaurar-excel" class="btn-subir-excel">Subir y Procesar</button>
                        </form>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <div id="modal-overlay" class="modal-overlay"></div>
    <div id="cliente-modal" class="modal"><div class="modal-content"><span class="close-btn" id="close-cliente-modal">&times;</span><h2>Editar Cliente</h2><form id="form-edit-cliente" class="admin-form"><input type="hidden" id="edit-cliente-id"><label>Nombre:</label><input type="text" id="edit-cliente-nombre" required><label>Email:</label><input type="email" id="edit-cliente-email" required><label>Teléfono:</label><input type="tel" id="edit-cliente-telefono"><label>Rol:</label><select id="edit-cliente-role"><option value="cliente">Cliente</option><option value="admin">Admin</option></select><button type="submit">Guardar</button></form></div></div>
    <div id="vehiculo-modal" class="modal"><div class="modal-content"><span class="close-btn" id="close-vehiculo-modal">&times;</span><h2>Editar Vehículo</h2><form id="form-edit-vehiculo" class="admin-form"><input type="hidden" id="edit-vehiculo-id"><label>Patente:</label><input type="text" id="edit-vehiculo-patente" required><label>Marca:</label><input type="text" id="edit-vehiculo-marca"><label>Modelo:</label><input type="text" id="edit-vehiculo-modelo"><label>Año:</label><input type="number" id="edit-vehiculo-anio"><button type="submit">Guardar</button></form></div></div>
    <div id="mantenimiento-modal" class="modal"><div class="modal-content"><span class="close-btn" id="close-mantenimiento-modal">&times;</span><h2>Editar Mantenimiento</h2><form id="form-edit-mantenimiento" class="admin-form"><input type="hidden" id="edit-mantenimiento-id"><label>Fecha:</label><input type="date" id="edit-mantenimiento-fecha" required><label>KM:</label><input type="number" id="edit-mantenimiento-km"><label>Trabajos:</label><textarea id="edit-mantenimiento-trabajos" rows="3"></textarea><label>Repuestos:</label><textarea id="edit-mantenimiento-repuestos" rows="2"></textarea><label>Sugerencia:</label><textarea id="edit-mantenimiento-sugerencia" rows="2"></textarea><label>Próximo KM:</label><input type="number" id="edit-mantenimiento-prox-km"><button type="submit">Guardar</button></form></div></div>

    <script src="admin.js"></script>
</body>
</html>
